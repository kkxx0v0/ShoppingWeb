<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="css/home.css">
<head>
    <title>在线商城TTT</title>
</head>

<body>
<div id="app">
    <div class="top">
        <a>
            <img src="/img/logo.jpg" alt="图片" class="banner" height="200" width="20%">
            <img src="/img/banner3.jpg" alt="图片" class="banner" height="200" width="20%">
            <img src="/img/slogan.jpg" alt="图片" class="banner" height="200" width="10%">
            <img src="/img/banner1.jpg" alt="图片" class="banner" height="200" width="20%">
            <img src="/img/banner2.jpg" alt="图片" class="banner" height="200" width="20%">
        </a>

        <div class="header">
            <button class="button">退出登录</button>
            <input placeholder="请输入商品名进行搜索" class="search-input">
            <button class="button">搜索</button>
            <button class="button">购物车</button>
        </div>

        <template>
            <div class="list">
                <div class="item" v-for="item in items" :key="item.id">
                    <img :src="item.imgPath" alt="图片" class="image" height="550" width="550">
                    <div class="info">
                        <p class="name">{{ item.name }}</p>
                        <p class="number">剩余数量: {{ item.count }}</p>
                        <p class="price">价格: {{ item.price }}</p>
                        <button @click="addCart(item.id)" class="button">加入购物车</button>
                    </div>
                </div>
            </div>
        </template>
    </div>
</div>


<script src="vue.js" type="text/javascript" charset="utf-8"></script>
<script src="axios-0.18.0.js"></script>
<script>
    new Vue({
        el: '#app',
        data: {
            search: '',
            items: [],
        },
        created() {
            this.getAll()
        },
        methods: {
            getAll(){
                axios.get("/item").then((res)=>{
                    this.items = res.data.data;
                    //console.log(res.data.data)
                })
            },
            getNeedId() {
                if (this.search !== ""){
                    axios.get("/item/" + this.search).then((res) => {
                        if (res.data.total === 0){
                            alert("未找到任何商品！")
                        } else {
                            this.items = res.data.data;
                        }
                    })
                } else {
                    alert("搜索内容不能为空！")
                    axios.get("/item").then((res)=>{
                        this.items = res.data.data;
                    })
                }
            },
            addCart(id) {
                //console.log(id)
                axios.get("/cart/" + id).then((res)=>{
                    alert(res.data.data)
                }).catch(function (error) {
                    if (error.response.status === 400) {
                        alert("未登录，自动跳转到登录页面！")
                        window.location.href = 'login.html'
                    }
                });
            },
            toCart() {
                window.location.href = 'cart.html';
            },
            toExit() {
                window.location.href = 'login.html';
            },
        }
    });
</script>

</body>
</html>